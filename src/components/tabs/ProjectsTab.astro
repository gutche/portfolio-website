---
import { projects } from "../../data/projects";

interface Props {
	class?: string;
}

const { class: className } = Astro.props;
---

<script>
	// Get all project items
	const projectItems = document.querySelectorAll(".project-item");

	// Add selected class to first project by default
	const firstProject = document.querySelector(".project-item");
	if (firstProject) {
		firstProject.classList.add("selected");
	}

	// Function to play switch sound
	const playSwitchSound = () => {
		const switchSound = document.getElementById(
			"switch-sound"
		) as HTMLAudioElement;
		const audioIndicator = document.getElementById("audioIndicator");
		if (
			switchSound &&
			audioIndicator?.classList.contains(
				"shadow-[0_0_10.4px_#00FF0A,0_0_3.2px_#00FF0A,0_0_3.2px_#00FF0A]"
			)
		) {
			switchSound.currentTime = 0;
			switchSound
				.play()
				.catch((e) => console.log("Error playing sound:", e));
		}
	};

	projectItems.forEach((item) => {
		item.addEventListener("click", () => {
			// Remove selected class from all projects
			projectItems.forEach((project) => {
				project.classList.remove("selected");
			});

			// Add selected class to clicked project
			item.classList.add("selected");

			const title = item.getAttribute("data-title");
			const description = item.getAttribute("data-description");
			const image = item.getAttribute("data-image");

			// Update desktop CRT
			const crtContainer = document.querySelector(".crt-container");
			if (crtContainer && (crtContainer as any).crtEffect) {
				(crtContainer as any).crtEffect.updateImage(image);
				(crtContainer as any).crtEffect.updateText(title, description);
			}

			// Update mobile CRT
			const mobileCrtContainer = document.querySelector(
				".crt-container-mobile"
			);
			if (mobileCrtContainer && (mobileCrtContainer as any).crtEffect) {
				(mobileCrtContainer as any).crtEffect.updateImage(image);
				(mobileCrtContainer as any).crtEffect.updateText(
					title,
					description
				);
			}

			// Play switch sound
			playSwitchSound();
		});
	});
</script>

<style>
	.project-item {
		background: rgba(0, 0, 0, 0.2);
		border-radius: 4px;
		cursor: pointer;
		transition: all 0.2s ease;
	}

	.project-item:hover {
		background: rgba(0, 0, 0, 0.3);
	}

	.project-item.selected {
		background: rgba(255, 255, 255, 0.1);
		border-color: rgba(255, 255, 255, 0.3);
		box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
	}
</style>
